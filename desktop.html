<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>Nagasaki Soyo | Gallery</title>
    <script>
        tailwind.config = {
            darkMode: false, 
        }
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Noto+Serif+JP:wght@400;600;700;900&family=Inter:wght@300;400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://unpkg.com/lenis@1.0.45/dist/lenis.min.js"></script>
    <style>
        body { margin: 0; overflow-x: hidden; background-color: #FEFEFE; font-family: 'Inter', 'Noto Sans SC', sans-serif; }
        ::-webkit-scrollbar { width: 0; }
        .font-script { font-family: 'Dancing Script', cursive; }
        .font-jp { font-family: 'Noto Serif JP', serif; }
        .anim-layer { position: absolute; inset: 0; pointer-events: none; z-index: 0; overflow: hidden; }
        .arrow-line { position: absolute; height: 2px; background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.6) 60%, rgba(255,255,255,1) 100%); transform-origin: right center; border-radius: 999px; box-shadow: 0 0 8px rgba(255,255,255,0.8); }
        .fixed-star { position: absolute; background: white; border-radius: 50%; box-shadow: 0 0 10px rgba(255,255,255,0.9); }
        .fixed-dot { position: absolute; background: rgba(255,255,255,0.6); border-radius: 50%; }
        .spinning-diamond { position: absolute; border: 2px solid rgba(255,255,255,0.9); transform: rotate(45deg); box-shadow: 0 0 15px rgba(255,255,255,0.4); opacity: 0; }
        .script-text { fill: transparent; stroke: white; stroke-width: 1.5px; stroke-dasharray: 1000; stroke-dashoffset: 1000; font-family: 'Dancing Script', cursive; font-size: 90px; font-weight: 700; filter: drop-shadow(0 0 5px rgba(255,255,255,0.5)); letter-spacing: 2px; }
        .logo-img { width: 220px; height: auto; object-fit: contain; }
        .bg-grid-animate { background-size: 40px 40px; background-image: linear-gradient(to right, rgba(255, 255, 255, 0.05) 1px, transparent 1px), linear-gradient(to bottom, rgba(255, 255, 255, 0.05) 1px, transparent 1px); animation: grid-move 20s linear infinite; }
        @keyframes grid-move { 0% { background-position: 0 0; } 100% { background-position: 40px 40px; } }
        .card-hover-effect { transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .card-hover-effect:hover { transform: translateY(-10px) scale(1.02); box-shadow: 0 20px 40px -10px rgba(99, 102, 241, 0.3); }
        .card-hover-effect:hover .card-overlay { opacity: 1; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        #detail-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; background-color: #f8fafc; opacity: 0; pointer-events: none; transition: opacity 0.4s ease; overflow-y: auto; }
        #detail-modal.active { opacity: 1; pointer-events: auto; }
        .toggle-checkbox { appearance: none; display: none; }
        .toggle-label { width: 40px; height: 22px; background-color: #cbd5e1; border-radius: 9999px; position: relative; cursor: pointer; transition: background-color 0.3s ease; }
        .toggle-label::after { content: ''; position: absolute; top: 2px; left: 2px; width: 18px; height: 18px; background-color: white; border-radius: 50%; box-shadow: 0 1px 2px rgba(0,0,0,0.1); transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1); }
        .toggle-checkbox:checked + .toggle-label.theme-blue { background-color: #3b82f6; }
        .toggle-checkbox:checked + .toggle-label.theme-red { background-color: #ef4444; }
        .toggle-checkbox:checked + .toggle-label.theme-green { background-color: #10b981; }
        .toggle-checkbox:checked + .toggle-label.theme-orange { background-color: #f59e0b; }
        .toggle-checkbox:checked + .toggle-label::after { transform: translateX(18px); }
        .anim-container { position: relative; width: 100%; height: 100%; overflow: hidden; }
        .anim-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; will-change: opacity, transform; display: flex; align-items: center; }
        img.anim-layer { object-fit: cover; }
        .layer-front { z-index: 10; opacity: 1; transform: scale(1); transform-origin: center center; transition: opacity 0.6s ease-out, transform 0.6s ease-out; }
        .layer-back { z-index: 1; opacity: 1; transform: scale(1); }
        .layer-front.anim-scale-fade { opacity: 0; transform: scale(1.15); }
        .layer-front.anim-fade-only { opacity: 0; transform: scale(1); }
        .modal-overlay { position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0); backdrop-filter: blur(0px); z-index: 10000; display: none; opacity: 0; transition: background-color 0.5s ease, backdrop-filter 0.5s ease; }
        .modal-overlay.active { display: flex; opacity: 1; background-color: rgba(0, 0, 0, 0.8); backdrop-filter: blur(8px); }
        .modal-content { position: relative; width: 100%; height: 100%; background: transparent; overflow: hidden; display: flex; align-items: center; justify-content: center; }
        .modal-image-container { position: absolute; transform-origin: center center; will-change: transform, width, height, top, left; }
        .modal-image { width: 100%; height: 100%; object-fit: contain; cursor: pointer; }
        .close-button { position: absolute; top: 20px; right: 20px; width: 40px; height: 40px; background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 50%; color: white; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; z-index: 10; opacity: 0; transform: scale(0.8); cursor: pointer; }
        .modal-overlay.active .close-button { opacity: 1; transform: scale(1); transition-delay: 0.4s; }
        .close-button:hover { background: rgba(255, 255, 255, 0.2); transform: scale(1.1); }
        body.modal-open { overflow: hidden; }
        #music-player-container { transform: translateX(65%); transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1); will-change: transform; }
        #music-player-container.expanded { transform: translateX(0); }
        .music-wave { display: flex; align-items: flex-end; height: 12px; gap: 2px; }
        .music-bar { width: 2px; background-color: white; animation: wave 1s ease-in-out infinite; }
        .music-bar:nth-child(1) { animation-duration: 0.8s; height: 40%; }
        .music-bar:nth-child(2) { animation-duration: 1.1s; height: 80%; }
        .music-bar:nth-child(3) { animation-duration: 1.3s; height: 50%; }
        .music-bar:nth-child(4) { animation-duration: 0.9s; height: 70%; }
        @keyframes wave { 0%, 100% { height: 20%; } 50% { height: 100%; } }
        .paused .music-bar { animation-play-state: paused; height: 20% !important; }
    </style>
</head>
<body>
    
    <div id="smooth-wrapper">
        <div id="smooth-content">
            <section class="h-screen w-full flex items-center justify-center relative z-10" 
         style="background-color: #FFFFFF !important;"
         id="first-page">
    <div class="absolute top-8 left-8 z-20">
        <img src="https://cdn.kedao.ggss.club/2026-1-24-16-35-29-image-file.png" class="logo-img" alt="MyGO!!!!! Logo">
    </div>
    <div class="w-[400px] max-w-[80%] aspect-square relative">
        <img src="https://cdn.kedao.ggss.club/2026-1-24-15-19-0-c5ca4e70503c4c7ca87d496cb13d09ff-file.png" class="w-full h-full object-contain" alt="Intro Image">
    </div>
    <div class="absolute bottom-10 text-slate-300 text-xs tracking-widest animate-bounce">SCROLL TO START</div>
</section>
            <section id="animation-stage" class="h-screen w-full relative overflow-hidden bg-[#1a0b2e] z-30">
                <div class="absolute inset-0 bg-gradient-to-br from-[#2d1b4e] via-[#1a0b2e] to-[#0f0518]"></div>
                <div class="anim-layer" id="anim-container">
                    <div class="fixed-star w-1 h-1 top-[15%] left-[20%]"></div>
                    <div class="fixed-dot w-2 h-2 top-[25%] left-[10%]"></div>
                    <div class="fixed-star w-2 h-2 top-[10%] right-[25%]"></div>
                    <div class="fixed-dot w-1 h-1 top-[20%] right-[15%]"></div>
                    <div class="fixed-star w-1.5 h-1.5 top-[40%] left-[50%]"></div>
                    <div class="fixed-dot w-2 h-2 bottom-[30%] left-[15%]"></div>
                    <div class="fixed-star w-1 h-1 bottom-[20%] right-[20%]"></div>
                    <div class="spinning-diamond w-12 h-12 bottom-[15%] left-[10%]" id="diamond-left"></div>
                    <div class="spinning-diamond w-16 h-16 top-[15%] right-[10%]" id="diamond-right"></div>
                    <div id="lines-container"></div>
                </div>
                <div class="absolute inset-0 flex flex-col items-center justify-center z-30">
                    <div class="relative z-20 w-full max-w-6xl h-[500px] flex items-center justify-center">
                        <svg viewBox="0 0 800 400" class="w-full h-full overflow-visible">
                            <text x="50%" y="35%" text-anchor="middle" class="script-text" id="text-nagasaki">Nagasaki</text>
                            <text x="50%" y="70%" text-anchor="middle" class="script-text" id="text-soyo">Soyo</text>
                        </svg>
                    </div>
                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[30vw] h-[30vw] z-10 opacity-0 scale-0" id="popup-image-container">
                        <img src="https://cdn.kedao.ggss.club/2026-1-31-4-53-36-273c3196a9fc6c37fc7f24e53109decf2815073-file.jpg" class="w-full h-full object-cover rounded-full shadow-[0_0_60px_rgba(255,255,255,0.4)] border border-white/30">
                    </div>
                </div>
            </section>
            <section id="gallery-section" class="relative w-full bg-slate-900 text-slate-800 pb-20">
                <div class="absolute inset-0 z-0">
                    <div class="absolute inset-0 bg-grid-animate opacity-30"></div>
                    <div class="absolute top-0 left-0 w-full h-64 bg-gradient-to-b from-[#0f0518] to-transparent pointer-events-none"></div>
                </div>
                <div class="relative z-10 container mx-auto px-4 pt-32">
                    <div class="w-full flex justify-between items-center mb-16 border-b border-slate-700 pb-6">
                        <div class="flex items-center space-x-3">
                            <img src="https://cdn.kedao.ggss.club/2026-1-31-2-26-24-2026-1-31-0-31-43-mygo-file-file.png" class="h-8 object-contain invert brightness-0 filter" style="filter: brightness(1);" alt="Logo">
                            <div class="h-4 w-[1px] bg-slate-600"></div>
                            <span class="text-slate-400 text-xs font-bold tracking-[0.2em]">MEMBER CARD GALLERY</span>
                        </div>
                    </div>
                    <div class="text-center mb-16">
                        <h1 class="text-5xl md:text-7xl font-black text-white tracking-tighter mb-4">
                            <span class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-cyan-300">迷子</span>でもいい、<br>前へ進め。
                        </h1>
                        <p class="text-slate-400 text-sm tracking-widest uppercase">不畏迷茫，迷茫着也要砥砺前行</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto" id="card-grid"></div>
                    <footer class="mt-24 py-8 text-center text-slate-600 text-xs border-t border-slate-800">
                        <p>© BanG Dream! It's MyGO!!!!! Fanmade Gallery</p>
                    </footer>
                </div>
            </section>
        </div>
    </div>
    <div id="detail-modal" class="flex items-center justify-center p-4 md:p-8">
        <button onclick="closeDetail()" class="fixed top-6 left-6 z-50 bg-white/80 backdrop-blur-md hover:bg-white text-slate-800 px-4 py-2 rounded-full shadow-lg flex items-center space-x-2 transition-all group cursor-pointer">
            <svg class="w-4 h-4 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
            <span class="text-xs font-bold uppercase tracking-wider">Back to Gallery</span>
        </button>
        <div id="detail-container" class="w-full max-w-6xl h-[85vh] md:h-[640px] relative z-10 mt-16 md:mt-0"></div>
    </div>
    <div class="modal-overlay" id="image-modal">
        <div class="modal-content" id="modal-content">
            <div class="modal-image-container" id="modal-image-container">
                <img class="modal-image" id="modal-image" src="" alt="Card Illustration">
            </div>
            <button class="close-button" id="close-modal">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18M6 6l12 12"></path>
                </svg>
            </button>
        </div>
    </div>
    <script>
        const lenis = new Lenis({ duration: 1.5, easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)), smooth: true });
        function raf(time) { lenis.raf(time); requestAnimationFrame(raf); }
        requestAnimationFrame(raf);
        gsap.registerPlugin(ScrollTrigger);
        gsap.to(".fixed-star", { opacity: 0.2, scale: 0.5, duration: 2, yoyo: true, repeat: -1, stagger: { each: 0.5, from: "random" }, ease: "sine.inOut" });
        gsap.to(".fixed-dot", { opacity: 0.1, duration: 3, yoyo: true, repeat: -1, stagger: { each: 0.8, from: "random" }, ease: "sine.inOut" });
        const diamondTl = gsap.timeline({ repeat: -1 });
        diamondTl.to("#diamond-left", { opacity: 1, scale: 1, duration: 0.5, ease: "back.out(1.7)" })
                 .to("#diamond-left", { rotation: 225, duration: 0.8, ease: "power2.inOut" })
                 .to("#diamond-left", { opacity: 0, scale: 0, duration: 0.5, ease: "power2.in" });
        diamondTl.to("#diamond-right", { opacity: 1, scale: 1, duration: 0.5, ease: "back.out(1.7)" }, "-=0.2")
                 .to("#diamond-right", { rotation: 225, duration: 0.8, ease: "power2.inOut" })
                 .to("#diamond-right", { opacity: 0, scale: 0, duration: 0.5, ease: "power2.in" });
        const linesContainer = document.getElementById('lines-container');
        function shootArrow() {
            const line = document.createElement('div');
            line.classList.add('arrow-line');
            const width = Math.random() * 200 + 100; 
            const startX = Math.random() * 80 + 10; 
            const startY = Math.random() * 80 - 40; 
            const angle = 135 + (Math.random() * 10 - 5); 
            line.style.width = `${width}px`;
            line.style.left = `${startX}%`;
            line.style.top = `${startY}%`;
            line.style.transform = `rotate(${angle}deg)`;
            linesContainer.appendChild(line);
            gsap.fromTo(line, 
                { x: 0, opacity: 0, scaleX: 0.2 },
                { x: -2000, y: 2000, opacity: 0, scaleX: 1, duration: Math.random() * 2.0 + 1.5, ease: "power1.in", onComplete: () => line.remove(), keyframes: [{ opacity: 0, percent: 0 }, { opacity: 0.8, percent: 10 }, { opacity: 0, percent: 100 }] }
            );
            setTimeout(shootArrow, Math.random() * 300 + 100); 
        }
        shootArrow(); setTimeout(shootArrow, 200); setTimeout(shootArrow, 400);
        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: "#animation-stage",
                start: "top top",
                end: "+=3000",
                pin: true,
                scrub: 1,
                anticipatePin: 1
            }
        });
        tl.to({}, { duration: 2 });
        tl.to(".script-text", { strokeDashoffset: 0, duration: 4, stagger: 1.5, ease: "power1.inOut" });
        tl.to(".script-text", { fill: "rgba(255,255,255,0.9)", duration: 1.5 }, "-=1");
        tl.to({}, { duration: 1 });
        tl.add("explode");
        tl.to("#popup-image-container", { scale: 1.5, opacity: 1, duration: 4, ease: "power3.inOut" }, "explode");
        tl.to("#text-nagasaki", { x: "-25vw", y: "-10vh", scale: 0.8, duration: 4, ease: "power3.inOut" }, "explode");
        tl.to("#text-soyo", { x: "25vw", y: "10vh", scale: 0.8, duration: 4, ease: "power3.inOut" }, "explode");
        const cards = [
            { id: "5015", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "趣水族館", subTitle: "Fun Aquarium", attr: "happy", rarity: 2, skill: { effect: "Life & Score Up", desc: "生命回复（300） 8秒内 得分提升10%", descJp: "ライフ回復（300） 8秒間 スコアが10%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-47-6-card_normal (14)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-47-12-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-47-6-card_normal (14)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-47-12-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-25-0-47-6-card_normal (14)-file.png" },
            { id: "10036", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "bilibili", subTitle: "Bilibili Collaboration", attr: "cool", rarity: 2, skill: { effect: "Life & Score Up", desc: "5秒内 BAD以下时生命不会减少 得分提升10%", descJp: "5秒間 BAD以下でもライフが減少しなくなり、スコアが10%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-44-8-card_normal (13)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-44-13-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-44-8-card_normal (13)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-44-13-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-25-0-44-8-card_normal (13)-file.png" },
            { id: "10045", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "罗森联动2025", subTitle: "Lawson Collaboration 2025", attr: "happy", rarity: 2, skill: { effect: "Perfect Lock", desc: "8秒内 GREAT变为PERFECT 得分提升10%", descJp: "8秒間 GREATがPERFECTになり、スコアが10%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-41-15-card_normal (12)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-41-26-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-41-15-card_normal (12)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-41-26-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-25-0-41-15-card_normal (12)-file.png" }, 
            { id: "1821/1899/2369", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "冷静的调停者", subTitle: "調停者は心静かに", attr: "happy", rarity: 3, skill: { effect: "Perfect Lock", desc: "7.5秒内 GREAT变为PERFECT 得分提升30%", descJp: "7.5秒間 GREATがPERFECTになり、スコアが30%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-28-6-card_normal (9)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-28-12-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-28-6-card_after_training (9)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-28-16-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-11-47-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-25-0-28-6-card_after_training (9)-file.png" },
            { id: "1811", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "大家的『妈妈』", subTitle: "みんなの『お母さん』", attr: "powerful", rarity: 1, skill: { effect: "Score Up", desc: "7秒内 得分提升10%", descJp: "7秒間 スコアが10%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-39-3-card_normal (11)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-39-15-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-39-3-card_normal (11)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-39-15-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-25-0-39-3-card_normal (11)-file.png" },
            { id: "1816", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "开始吧，一辈子的约定", subTitle: "一生を、はじめよう", attr: "cool", rarity: 2, skill: { effect: "Life & Score Up", desc: "5秒内 BAD以下时生命不会减少 得分提升10%", descJp: "5秒間 BAD以下でもライフが減少しなくなり、スコアが10%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-30-7-card_normal (10)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-30-14-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-30-7-card_normal (10)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-30-14-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-25-0-30-7-card_normal (10)-file.png" },
            { id: "1825", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "我来结束这一切", subTitle: "終わらせてあげる", attr: "pure", rarity: 5, skill: { effect: "Life & Score Up", desc: "生命回复750 7.5秒内 得分提升110%", descJp: "ライフ回復750 7.5秒間 スコアが110%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-16-49-card_normal (8)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-16-54-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-16-49-card_after_training (8)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-16-59-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-11-47-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-25-0-16-49-card_after_training (8)-file.png" },
            { id: "1855", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "放松力气", subTitle: "肩の力を抜いて", attr: "happy", rarity: 2, skill: { effect: "Perfect Lock", desc: "8秒内 GREAT变为PERFECT 得分提升10%", descJp: "8秒間 GREATがPERFECTになり、スコアが10%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-10-51-card_normal-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-10-58-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-10-51-card_normal-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-10-58-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-25-0-10-51-card_normal-file.png" },
            { id: "1936", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "雨一直下", subTitle: "雨はずっと", attr: "cool", rarity: 5, skill: { effect: "Score Up", desc: "7秒内 得分提升130%", descJp: "7秒間 スコアが130%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-7-26-card_normal (6)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-7-32-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-25-0-7-26-card_after_training (7)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-25-0-7-37-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-11-47-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-25-0-7-26-card_after_training (7)-file.png" },
            { id: "1992", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "Hopeful birthday！", subTitle: "", attr: "happy", rarity: 4, skill: { effect: "Life & Score Up", desc: "生命回复450 7秒内 BAD以下时不会减少生命。且7秒内 得分提升40% 到GREAT以下出现为止得分提升100%", descJp: "ライフ回復450 7秒間 BAD以下でもライフが減少しなくなり、かつ7秒間 スコアが40%UPする GREAT以下が出るまでスコアが100%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-24-23-52-52-card_after_training (6)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-23-52-59-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-11-47-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-24-23-52-52-card_after_training (6)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-23-52-59-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-11-47-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-24-23-52-52-card_after_training (6)-file.png" },
            { id: "2125", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "这种关系的名字是", subTitle: "この繋がりの名前は", attr: "powerful", rarity: 5, skill: { effect: "Score Up", desc: "7秒内 仅在PERFECT时得分提升150%", descJp: "7秒間 PERFECTのみスコアが150%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-24-23-47-26-card_normal (5)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-23-47-36-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-24-23-47-26-card_after_training (5)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-23-47-40-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-11-47-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-24-23-47-26-card_after_training (5)-file.png" },
            { id: "2162", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "我们用我们的方法", subTitle: "こちらはこちらで", attr: "happy", rarity: 4, skill: { effect: "Score Up", desc: "7秒内 得分提升90% 到GREAT以下出现为止 得分提升110%", descJp: "7秒間 スコアが90%UPする GREAT以下が出るまでスコアが110%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-24-23-44-56-card_normal (4)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-23-45-7-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-24-23-44-56-card_after_training (4)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-23-45-14-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-11-47-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-24-23-44-56-card_after_training (4)-file.png" },
            { id: "2177", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "开幕前的片刻", subTitle: "幕開け前のひととき", attr: "pure", rarity: 5, skill: { effect: "Score Up", desc: "7秒内 得分提升130%", descJp: "7秒間 スコアが130%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-24-23-38-19-card_normal (3)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-23-38-33-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-24-23-38-22-card_after_training (3)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-23-38-40-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-11-47-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-24-23-38-22-card_after_training (3)-file.png" },
            { id: "2205", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "时间长河的尽头", subTitle: "時の流れの先に", attr: "happy", rarity: 5, skill: { effect: "Perfect Lock", desc: "7.5秒内 BAD以上全部变为PERFECT 得分提升110％", descJp: "7.5秒間 BAD以上がすべてPERFECTになり、スコアが110%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-24-23-31-1-card_normal (2)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-23-31-23-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-24-23-31-14-card_after_training (2)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-23-31-27-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-11-47-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-24-23-31-14-card_after_training (2)-file.png" },
            { id: "2232", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "只是过于耀眼", subTitle: "ただ眩しくて", attr: "powerful", rarity: 5, skill: { effect: "Life & Score Up", desc: "7秒内 BAD以下时生命不会减少 得分提升110%", descJp: "7秒間 BAD以下でもライフが減少しなくなり、スコアが110％UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-24-23-15-24-card_normal (1)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-23-15-56-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-12-22-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-24-23-15-43-card_after_training (1)-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-23-16-25-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-23-11-47-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-24-23-15-43-card_after_training (1)-file.png" },
            { id: "2289", name: "长崎爽世", nameRomaji: "Nagasaki Soyo", title: "新たに芽吹くもの", subTitle: "New Sprouts", attr: "cool", rarity: 3, skill: { effect: "Score Up", desc: "7秒内 得分提升60%", descJp: "7秒間 スコアが60%UPする" }, data: { untrained: { main: "https://cdn.kedao.ggss.club/2026-1-24-22-5-53-card_normal-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-22-40-20-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-22-7-50-image-file.png" }, trained: { main: "https://cdn.kedao.ggss.club/2026-1-24-22-6-22-card_after_training-file.png", avatar: "https://cdn.kedao.ggss.club/2026-1-24-22-40-34-image-file.png", star: "https://cdn.kedao.ggss.club/2026-1-24-22-7-8-image-file.png" } }, preview: "https://cdn.kedao.ggss.club/2026-1-24-22-6-22-card_after_training-file.png" }
        ];
        const assets = {
            icons: { cool: "https://cdn.kedao.ggss.club/2026-1-24-22-1-42-image-file.png", powerful: "https://cdn.kedao.ggss.club/2026-1-24-23-10-33-image-file.png", happy: "https://cdn.kedao.ggss.club/2026-1-24-23-8-38-image-file.png", pure: "https://cdn.kedao.ggss.club/2026-1-24-23-10-58-image-file.png", mygo: "https://cdn.kedao.ggss.club/2026-1-24-22-8-19-mygo-file.png", mygoRed: "https://cdn.kedao.ggss.club/2026-1-24-23-12-40-mygo-file.png" },
            themes: { cool: { bg: "bg-[#eef2ff]", attrBg: "bg-[#eff6ff]", attrText: "text-blue-400", skillBg: "bg-blue-50", skillText: "text-blue-600", subTitle: "text-blue-500", glow: "bg-blue-600/20", headerText: "text-blue-200", toggle: "theme-blue" }, powerful: { bg: "bg-[#fef2f2]", attrBg: "bg-[#fef2f2]", attrText: "text-red-400", skillBg: "bg-red-50", skillText: "text-red-600", subTitle: "text-red-500", glow: "bg-red-600/20", headerText: "text-red-200", toggle: "theme-red" }, happy: { bg: "bg-[#fffbeb]", attrBg: "bg-[#fffbeb]", attrText: "text-orange-400", skillBg: "bg-orange-50", skillText: "text-orange-600", subTitle: "text-orange-500", glow: "bg-orange-600/20", headerText: "text-orange-200", toggle: "theme-orange" }, pure: { bg: "bg-[#f0fdf4]", attrBg: "bg-[#f0fdf4]", attrText: "text-green-400", skillBg: "bg-green-50", skillText: "text-green-600", subTitle: "text-green-500", glow: "bg-green-600/20", headerText: "text-green-200", toggle: "theme-green" } }
        };
        function initGallery() {
            const grid = document.getElementById('card-grid');
            grid.innerHTML = cards.map((card, index) => {
                const theme = assets.themes[card.attr];
                return `<div onclick="openDetail(${index})" class="group cursor-pointer relative aspect-[3/4] rounded-2xl overflow-hidden card-hover-effect bg-slate-800 border border-slate-700">
                            <img src="${card.preview}" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity duration-500">
                            <div class="absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent opacity-90"></div>
                            <div class="absolute bottom-0 left-0 w-full p-6">
                                <div class="flex items-center space-x-2 mb-2">
                                    <img src="${assets.icons[card.attr]}" class="w-5 h-5">
                                    <span class="text-[10px] font-bold ${theme.attrText} uppercase tracking-widest">${card.attr}</span>
                                </div>
                                <h3 class="text-2xl font-bold text-white mb-1 leading-tight">${card.title}</h3>
                                <p class="text-xs text-slate-400 font-jp">${card.name}</p>
                                <div class="card-overlay opacity-0 transition-opacity duration-300 mt-4 flex items-center space-x-2">
                                    <span class="text-[10px] font-bold text-white bg-white/20 backdrop-blur px-3 py-1 rounded-full">VIEW CARD</span>
                                </div>
                            </div>
                        </div>`;
            }).join('');
        }
        function openDetail(index) {
            const card = cards[index];
            const theme = assets.themes[card.attr];
            const container = document.getElementById('detail-container');
            const modal = document.getElementById('detail-modal');
if (card.id === "1825") {
    // 使用全局函数控制音乐
    if (typeof window.pauseMainMusic === 'function') {
        window.pauseMainMusic();
    }
    if (typeof window.playDetailMusic === 'function') {
        window.playDetailMusic();
        // 添加状态标记
        window.isDetailAudioPlaying = true;
    }
}
            lenis.stop();
            const getStars = (src) => Array(card.rarity).fill(`<img class="h-4 w-auto object-contain" src="${src}">`).join('');
            container.innerHTML = `<main class="relative w-full h-full bg-white rounded-[32px] shadow-2xl overflow-hidden flex flex-col md:flex-row">
                    <aside class="w-full md:w-[360px] flex flex-col bg-white z-20 flex-shrink-0 h-full overflow-y-auto no-scrollbar border-r border-gray-100">
                        <header class="bg-[#0f172a] px-8 py-10 flex flex-col justify-center h-48 relative overflow-hidden">
                            <div class="absolute -top-10 -right-10 w-40 h-40 ${theme.glow} rounded-full blur-3xl"></div>
                            <div class="relative z-10 space-y-1">
                                <div class="text-[10px] font-bold ${theme.headerText} tracking-[0.15em] uppercase mb-2 opacity-80">MyGO!!!!!</div>
                                <h1 class="text-4xl font-black text-white tracking-tight leading-none">${card.name}</h1>
                                <p class="text-xs font-bold text-slate-400 tracking-[0.2em] uppercase pt-1">${card.nameRomaji}</p>
                            </div>
                        </header>
                        <div class="flex-1 px-8 py-8 space-y-8">
                            <div class="flex items-center space-x-5">
                                <div class="relative flex-shrink-0">
                                    <div class="w-[72px] h-[72px] rounded-full border-[3px] border-white shadow-md overflow-hidden bg-gray-100">
                                        <div class="anim-container" id="avatar-container">
                                            <img class="anim-layer layer-back" src="${card.data.untrained.avatar}">
                                            <img class="anim-layer layer-front" src="${card.data.untrained.avatar}">
                                        </div>
                                    </div>
                                    <div class="absolute -bottom-1 -right-2 bg-white rounded-full p-0.5 shadow-sm border border-gray-100 flex items-center justify-center z-20 w-6 h-6">
                                        <img src="${card.attr === 'powerful' ? assets.icons.mygoRed : assets.icons.mygo}" class="w-full h-full object-contain">
                                    </div>
                                </div>
                                <div>
                                    <h2 class="text-lg font-bold text-slate-800 leading-tight">${card.title}</h2>
                                    <p class="text-[10px] font-bold ${theme.subTitle} uppercase mt-1 tracking-wide">${card.subTitle}</p>
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="${theme.attrBg} rounded-xl p-3 flex flex-col justify-center h-20">
                                    <span class="text-[10px] font-bold ${theme.attrText} uppercase mb-1 tracking-wider">Attribute</span>
                                    <div class="flex items-center space-x-2">
                                        <img src="${assets.icons[card.attr]}" class="w-5 h-5">
                                        <span class="text-base font-black text-slate-800 uppercase">${card.attr}</span>
                                    </div>
                                </div>
                                <div class="bg-[#fefce8] rounded-xl p-3 flex flex-col justify-center h-20">
                                    <span class="text-[10px] font-bold text-yellow-500 uppercase mb-1 tracking-wider">Rarity</span>
                                    <div class="anim-container h-6 w-full" id="stars-container">
                                        <div class="anim-layer layer-back flex space-x-0.5">${getStars(card.data.untrained.star)}</div>
                                        <div class="anim-layer layer-front flex space-x-0.5">${getStars(card.data.untrained.star)}</div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Skill Effect</span>
                                    <span class="px-2 py-1 ${theme.skillBg} ${theme.skillText} text-[10px] font-bold rounded-md uppercase">${card.skill.effect}</span>
                                </div>
                                <div class="bg-slate-50 rounded-2xl p-5 border border-slate-100">
                                    <p class="text-sm font-bold text-slate-800 mb-1.5">${card.skill.desc}</p>
                                    <p class="text-[10px] text-slate-400 font-medium leading-relaxed">${card.skill.descJp}</p>
                                </div>
                            </div>
                            <div class="pt-6 border-t border-slate-100 flex items-center justify-between mt-auto">
                                <div class="flex items-center space-x-3">
                                    <span class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Training Status</span>
                                    <div class="flex items-center">
                                        <input type="checkbox" id="training-toggle" class="toggle-checkbox" ${card.data.untrained.main === card.data.trained.main ? 'disabled' : ''}>
                                        <label for="training-toggle" class="toggle-label ${theme.toggle} ${card.data.untrained.main === card.data.trained.main ? 'opacity-50 cursor-not-allowed' : ''}"></label>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <span class="text-[10px] font-bold text-slate-300 uppercase">Card ID ${card.id}</span>
                                </div>
                            </div>
                        </div>
                    </aside>
                    <section class="relative flex-1 bg-slate-200 h-full overflow-hidden group" id="main-illustration-area">
                        <div class="anim-container" id="main-container">
                            <img class="anim-layer layer-back" src="${card.data.untrained.main}">
                            <img class="anim-layer layer-front" src="${card.data.untrained.main}">
                        </div>
                        <div class="absolute inset-x-0 bottom-0 h-40 bg-gradient-to-t from-black/30 to-transparent pointer-events-none z-20"></div>
                        <button class="absolute top-8 left-8 bg-white/90 backdrop-blur-md hover:bg-white text-slate-900 text-[10px] font-bold py-2.5 px-5 rounded-lg shadow-lg transition-all transform hover:scale-105 tracking-widest uppercase z-30" id="view-image-btn">Illustration View</button>
                    </section>
                </main>`;
            modal.classList.add('active');
            initDetailLogic(card);
        }
        let currentImageUrl = "";
        function initDetailLogic(card) {
            const toggle = document.getElementById('training-toggle');
            const viewImageBtn = document.getElementById('view-image-btn');
            currentImageUrl = card.data.untrained.main;
            new Image().src = card.data.trained.main;
            new Image().src = card.data.trained.avatar;
            const getStarsHTML = (starSrc) => { return Array(card.rarity).fill(`<img class="h-4 w-auto object-contain" src="${starSrc}">`).join(''); };
            function performCrossFade(containerId, newData, isHtmlContent = false, animationType = 'scale') {
                const container = document.getElementById(containerId);
                if(!container) return;
                const frontLayer = container.querySelector('.layer-front');
                const backLayer = container.querySelector('.layer-back');
                if (containerId === 'main-container') { currentImageUrl = newData; }
                if (isHtmlContent) { backLayer.innerHTML = newData; } else { backLayer.src = newData; }
                const animClass = animationType === 'scale' ? 'anim-scale-fade' : 'anim-fade-only';
                requestAnimationFrame(() => { frontLayer.classList.add(animClass); });
                setTimeout(() => {
                    if (isHtmlContent) { frontLayer.innerHTML = newData; } else { frontLayer.src = newData; }
                    frontLayer.style.transition = 'none';
                    frontLayer.classList.remove(animClass);
                    frontLayer.offsetHeight;
                    frontLayer.style.transition = '';
                }, 600);
            }
            if (card.data.untrained.main !== card.data.trained.main) {
                toggle.addEventListener('change', function() {
                    const isTrained = this.checked;
                    const data = isTrained ? card.data.trained : card.data.untrained;
                    performCrossFade('main-container', data.main, false, 'scale');
                    performCrossFade('avatar-container', data.avatar, false, 'scale');
                    performCrossFade('stars-container', getStarsHTML(data.star), true, 'fade');
                });
            }
            viewImageBtn.addEventListener('click', openImageModal);
        }
        function closeDetail() {
            const modal = document.getElementById('detail-modal');
            modal.classList.remove('active');
if (typeof window.isDetailAudioPlaying !== 'undefined' && window.isDetailAudioPlaying) {
    // 使用全局函数恢复音乐
    if (typeof window.resumeMainMusic === 'function') {
        window.resumeMainMusic();
    }
    window.isDetailAudioPlaying = false;
}
            lenis.start();
        }
        const imageModal = document.getElementById('image-modal');
        const modalImageContainer = document.getElementById('modal-image-container');
        const modalImage = document.getElementById('modal-image');
        const closeModalBtn = document.getElementById('close-modal');
        function openImageModal() {
            const mainImage = document.querySelector('#main-container .layer-front');
            if(!mainImage) return;
            const rect = mainImage.getBoundingClientRect();
            modalImage.src = currentImageUrl;
            imageModal.style.display = 'flex';
            document.body.classList.add('modal-open');
            modalImageContainer.style.width = rect.width + 'px';
            modalImageContainer.style.height = rect.height + 'px';
            modalImageContainer.style.left = rect.left + 'px';
            modalImageContainer.style.top = rect.top + 'px';
            modalImageContainer.style.transform = 'scale(1)';
            modalImageContainer.style.transition = 'none';
            modalImageContainer.offsetHeight;
            setTimeout(() => {
                imageModal.classList.add('active');
                const targetWidth = Math.min(rect.width * 1.1, window.innerWidth * 0.9);
                const targetHeight = Math.min(rect.height * 1.1, window.innerHeight * 0.9);
                const centerX = window.innerWidth / 2;
                const centerY = window.innerHeight / 2;
                setTimeout(() => {
                    modalImageContainer.style.transition = 'all 0.6s ease-out';
                    modalImageContainer.style.width = targetWidth + 'px';
                    modalImageContainer.style.height = targetHeight + 'px';
                    modalImageContainer.style.left = (centerX - targetWidth / 2) + 'px';
                    modalImageContainer.style.top = (centerY - targetHeight / 2) + 'px';
                }, 50);
            }, 10);
        }
        function closeImageModal() {
            imageModal.classList.remove('active');
            setTimeout(() => {
                imageModal.style.display = 'none';
                document.body.classList.remove('modal-open');
            }, 500);
        }
        closeModalBtn.addEventListener('click', closeImageModal);
        modalImage.addEventListener('click', closeImageModal);
        imageModal.addEventListener('click', (e) => { if (e.target === imageModal) closeImageModal(); });
        document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && imageModal.classList.contains('active')) closeImageModal(); });
        initGallery();
        document.addEventListener('DOMContentLoaded', function() {
            const player = document.getElementById('music-player-container');
            const audio = document.getElementById('bgm-audio');
            const iconPlaying = document.getElementById('icon-playing');
            const iconPaused = document.getElementById('icon-paused');
            const statusText = document.getElementById('music-status-text');
            if (!player || !audio) return;
            let hoverTimer = null;
            let autoHideTimer = null;
            let isExpanded = false;
            player.addEventListener('mouseenter', function() {
                if (autoHideTimer) { clearTimeout(autoHideTimer); autoHideTimer = null; }
                if (!isExpanded) { player.classList.add('expanded'); isExpanded = true; }
            });
            player.addEventListener('mouseleave', function() {
                if (autoHideTimer) { clearTimeout(autoHideTimer); }
                autoHideTimer = setTimeout(() => {
                    if (isExpanded) { player.classList.remove('expanded'); isExpanded = false; }
                }, 500);
            });
            let isPlaying = false;
            function togglePlayback() {
                if (isPlaying) { audio.pause(); } else { audio.play().catch(e => { console.warn("自动播放被阻止:", e); }); }
                updatePlayState(!isPlaying);
            }
            function updatePlayState(playing) {
                isPlaying = playing;
                if (!isDetailAudioPlaying) {
                    if (iconPlaying) iconPlaying.style.display = playing ? 'flex' : 'none';
                    if (iconPaused) iconPaused.style.display = playing ? 'none' : 'block';
                    if (statusText) statusText.textContent = playing ? 'PLAYING' : 'PAUSED';
                    if (iconPlaying) { iconPlaying.classList.toggle('paused', !playing); }
                }
            }
            audio.addEventListener('play', () => updatePlayState(true));
            audio.addEventListener('pause', () => updatePlayState(false));
            player.addEventListener('click', function(e) {
                if (isExpanded) { togglePlayback(); e.stopPropagation(); }
            });
            updatePlayState(false);
            audio.addEventListener('error', function() { console.error('音频加载失败'); if (statusText) statusText.textContent = 'ERROR'; });
        });


// =========================================
// 同时暴露给全局，让主页可以调用
// =========================================
window.initDesktopScripts = function() {
    console.log('初始化电脑版脚本...');
    initGallery(); // 确保初始化画廊
    
    // 初始化音乐状态变量
    if (typeof window.isDetailAudioPlaying === 'undefined') {
        window.isDetailAudioPlaying = false;
    }
    
    console.log('电脑版初始化完成');
};
        
        // 确保DOM加载后执行
        document.addEventListener('DOMContentLoaded', function() {
            initGallery();
        });
    </script>
</body>
</html>
